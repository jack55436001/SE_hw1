import java.util.*;

public class UI {
	private GradeSystems gradeSystems;
	private Scanner scanner;
	
	/* method  UI----------------------------------------------------------------------------------                                                                                                    
	* UI建構子
	*
	* @param 無
	* @return 無
	*
	* @throws 無
	*	
	*Pseudo code:
	*1.創建一個GradeSystems與一個Scanner
    *
	* Time estimate : O (1)
	* Example: ui = new UI()  建立一個新的UI
	----------------------------------------------------------------------------------------------------------*/
	public UI(){
		gradeSystems = new GradeSystems();
		scanner = new Scanner(System.in);
	}
	
	/* method  finalize----------------------------------------------------------------------------------                                                                                                    
	* override finalize確保Scanner在最後有關閉
	*
	* @param 無
	* @return 無
	*
	* @throws 無
	*	
	*Pseudo code:
	*1.Call Scanner的Close method
    *
	* Time estimate : O (1)
	* Example: ui.finalize() 在UI object delete前會呼叫
	----------------------------------------------------------------------------------------------------------*/
	@Override
	public void finalize()
	{
		scanner.close();
	}
	
	/* method  checkID----------------------------------------------------------------------------------                                                                                                    
	* 確認該學號是否存在於gradeSystems
	*
	* @param id 學生學號
	* @return boolean 存在與否
	*
	* @throws 無
	*	
	*Pseudo code:
	*1.gradeSystems call containsID這個method,並回傳之
    *
	* Time estimate : O (1)
	* Example: isExist = ui.checkID(103062319) 確認此學號是否存在於gradeSystems
	----------------------------------------------------------------------------------------------------------*/
	public boolean checkID(int id){
		return gradeSystems.containsID(id);
	}
	
	/* method  promptID----------------------------------------------------------------------------------                                                                                                    
	* 螢幕顯示並且輸入學號
	*
	* @param 無
	* @return id 學號
	*
	* @throws 無
	*	
	*Pseudo code:
	*1.螢幕顯示輸入ID
	*2.利用變數id記住使用者輸入的學號
	*3.回傳id
    *
	* Time estimate : O (1)
	* Example: id = ui.promptID()  螢幕顯示與輸入學號後,回傳學號
	----------------------------------------------------------------------------------------------------------*/
	public String promptID(){
		String id;
		System.out.println("請輸入ID 或 輸入Q離開：");
		id = scanner.next();
		return id;
	}
	
	/* method  showFinishMsg----------------------------------------------------------------------------------                                                                                                    
	* 顯示結束畫面
	*
	* @param 無
	* @return 無
	*
	* @throws 無
	*	
	*Pseudo code:
	*1.顯示結束畫面
    *
	* Time estimate : O (1)
	* Example: showFinishMsg()  顯示結束畫面
	----------------------------------------------------------------------------------------------------------*/
	public void showFinishMsg(){
		System.out.println("謝謝使用本系統");
	}
	
	/* method  showWelcomeMsg----------------------------------------------------------------------------------                                                                                                    
	* 顯示登入畫面
	*
	* @param id 學號
	* @return 無
	*
	* @throws 無
	*	
	*Pseudo code:
	*1.呼叫gradeSystems的findNameByID method取得使用者名稱
	*2.螢幕顯示歡迎與使用者名稱
    *
	* Time estimate : O (1)
	* Example: showWelcomeMsg(103062319)  螢幕顯示“歡迎 JSharp”
	----------------------------------------------------------------------------------------------------------*/
	public void showWelcomeMsg(int id){
		String name = gradeSystems.findNameByID(id);
		System.out.println("歡迎 "+name);
	}
	
	/* method  promptCommand----------------------------------------------------------------------------------                                                                                                    
	* 顯示可輸入的指令,並呼叫適當的method處理該指令
	*
	* @param id 學號
	* @return boolean 是否離開系統
	*
	* @throws CommandException-當輸入非螢幕指定的指令
	*		  InputMismatchException-
	*Pseudo code:
	*1.
    *
	* Time estimate : O (1)
	* Example: 
	----------------------------------------------------------------------------------------------------------*/
	public boolean promptCommand(int id){
		System.out.println("輸入指令\n1) G 顯示成績 (Grade)\n2) "
				+ "R 顯示排名 (Rank)\n3) A 顯示平均 (Average)\n4) W 更新配分 (Weight)\n5) E 離開選單 (Exit)");
		try{
			String command = scanner.next();     
			if(command.equals("G"))	   gradeSystems.showGrade(id);
			else if(command.equals("R"))	gradeSystems.showRank(id);
			else if(command.equals("A"))	gradeSystems.showAverage();
			else if(command.equals("W"))	weightFunction();
			else if(command.equals("E"))	return false;
			else	throw new CommandException();
		}
		catch(CommandException e){
			e.CommandError();
		}
		catch(InputMismatchException e){
			System.out.println("Please enter number between 0 to 100.");
		}
		promptExit();
		return true;
	}
	
	/* method  ----------------------------------------------------------------------------------                                                                                                    
	* 
	*
	* @param 
	* @return 
	*
	* @throws 
	*	
	*Pseudo code:
	*1.
    *
	* Time estimate : O (1)
	* Example: 
	----------------------------------------------------------------------------------------------------------*/
	private void weightFunction()
	{
		gradeSystems.showOldWeights();
		int [] newWeights=getNewWeights();
		showNewWeights(newWeights);
		System.out.println("以上正確嗎? Y (Yes) 或 N (No)");
		String t = scanner.next();
		try{
			if(t.equals("Y"))	gradeSystems.updateWeights(newWeights);
			else if(t.equals("N"))	System.out.println("Weights not change");
			else throw new CommandException();
		}
		catch(CommandException e){
			e.CommandError();
		}
	}
	
	/* method  ----------------------------------------------------------------------------------                                                                                                    
	* 
	*
	* @param 
	* @return 
	*
	* @throws 
	*	
	*Pseudo code:
	*1.
    *
	* Time estimate : O (1)
	* Example: 
	----------------------------------------------------------------------------------------------------------*/
	public void promptExit(){
		System.out.println("請輸入 Ｅ 回到主選單");
		
		while(true){
			String command = scanner.next();
			if(command.equals("E"))break;
		}
		
	}
	
	/* method  ----------------------------------------------------------------------------------                                                                                                    
	* 
	*
	* @param 
	* @return 
	*
	* @throws 
	*	
	*Pseudo code:
	*1.
    *
	* Time estimate : O (1)
	* Example: 
	----------------------------------------------------------------------------------------------------------*/
	private int[] getNewWeights() throws InputMismatchException{
		int[] newWeights = {0,0,0,0,0};
		System.out.println("---New Weights(%)---");
		System.out.println("Lab1: ");
		newWeights[0] = scanner.nextInt();
		System.out.println("Lab2: ");
		newWeights[1] = scanner.nextInt();
		System.out.println("Lab3: ");
		newWeights[2] = scanner.nextInt();
		System.out.println("midTerm: ");
		newWeights[3] = scanner.nextInt();
		System.out.println("finalExam: ");
		newWeights[4] = scanner.nextInt();
		
		return newWeights;
	}
	
	/* method  ----------------------------------------------------------------------------------                                                                                                    
	* 
	*
	* @param 
	* @return 
	*
	* @throws 
	*	
	*Pseudo code:
	*1.
    *
	* Time estimate : O (1)
	* Example: 
	----------------------------------------------------------------------------------------------------------*/
	public void showNewWeights(int [] NewWeights){
		System.out.println("---Confirm New Weights(%)---");
		System.out.println("Lab1: " + (int)(NewWeights[0]) +"%");
		System.out.println("Lab2: " + (int)(NewWeights[1])+"%");
		System.out.println("Lab3: " + (int)(NewWeights[2]) +"%");
		System.out.println("midTerm: " + (int)(NewWeights[3]) +"%");
		System.out.println("finalExam: " + (int)(NewWeights[4]) +"%");
	}
}
